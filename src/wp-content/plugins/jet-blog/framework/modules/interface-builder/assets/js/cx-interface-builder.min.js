!function(t,e){"use strict";var i={init:function(){this.component.init(),t(document).on("cxFramework:interfaceBuilder:component",this.component.init.bind(this.component)),this.control.init(),t(document).on("cxFramework:interfaceBuilder:control",this.control.init.bind(this.control))},component:{tabClass:".cx-tab",accordionClass:".cx-accordion",toggleClass:".cx-toggle",buttonClass:".cx-component__button",contentClass:".cx-settings__content",buttonActiveClass:"active",showClass:"show",localStorage:{},controlConditions:window.cxInterfaceBuilder.conditions||{},controlValues:window.cxInterfaceBuilder.fields||{},conditionState:{},init:function(){this.localStorage=this.getState()||{},this.componentInit(this.tabClass),this.componentInit(this.accordionClass),this.componentInit(this.toggleClass),this.addEvent(),this.conditionsHandleInit()},addEvent:function(){t("body").off("click.cxInterfaceBuilder").on("click.cxInterfaceBuilder",this.tabClass+" "+this.buttonClass+", "+this.toggleClass+" "+this.buttonClass+", "+this.accordionClass+" "+this.buttonClass,this.componentClick.bind(this))},conditionsHandleInit:function(){var e=this;t(window).on("cx-switcher-change",function(t){var i=t.controlName,n=t.controlStatus;e.updateConditionRules(i,n),e.renderConditionRules()}),t(window).on("cx-select-change",function(t){var i=t.controlName,n=t.controlStatus;e.updateConditionRules(i,n),e.renderConditionRules()}),t(window).on("cx-select2-change",function(t){var i=t.controlName,n=t.controlStatus;e.updateConditionRules(i,n),e.renderConditionRules()}),t(window).on("cx-radio-change",function(t){var i=t.controlName,n=t.controlStatus;e.updateConditionRules(i,n),e.renderConditionRules()}),t(window).on("cx-checkbox-change",function(n){var a=n.controlName,s=n.controlStatus,o={};t.each(s[a],function(t,e){o[t]=i.utils.filterBoolValue(e)}),e.updateConditionRules(a,o),e.renderConditionRules()}),this.generateConditionRules(),e.renderConditionRules()},generateConditionRules:function(){var e=this;t.each(this.controlConditions,function(i,n){t.each(n,function(t,i){e.controlValues.hasOwnProperty(t)&&(e.conditionState[t]=e.controlValues[t])})})},updateConditionRules:function(t,e){this.conditionState[t]=e},renderConditionRules:function(){var e=this;t.each(this.controlConditions,function(i,n){var a=t('.cx-control[data-control-name="'+i+'"]'),s=!0;a.addClass("cx-control-hidden"),t.each(n,function(i,n){if(s=!0,e.conditionState.hasOwnProperty(i)&&("string"==typeof n?e.conditionState[i]===n&&(s=!1):-1!==n.indexOf(e.conditionState[i])&&(s=!1),"object"==typeof e.conditionState[i]&&(s=!1,t.each(e.conditionState[i],function(t,e){if(!e&&-1!==n.indexOf(t))return s=!0,!1}))),s)return!1}),s?a.addClass("cx-control-hidden"):a.removeClass("cx-control-hidden")})},componentInit:function(e){var i=this,n=null,a=null,s=null,o="";t(e).each(function(c,r){switch(r=t(r),n=r.data("compotent-id"),e){case i.toggleClass:i.localStorage[n]&&i.localStorage[n].length&&(o=i.localStorage[n].join(", ")),t(i.contentClass,r).not(o).addClass(i.showClass).prevAll(i.buttonClass).addClass(i.buttonActiveClass);break;case i.tabClass:case i.accordionClass:i.localStorage[n]?(s=i.localStorage[n][0],a=t('[data-content-id="'+s+'"]',r)):(a=t(i.buttonClass,r).eq(0),s=a.data("content-id")),i.showElement(a,r,s)}})},componentClick:function(e){var i,n=t(e.target),a=n.closest(this.tabClass+", "+this.accordionClass+", "+this.toggleClass),s=new RegExp(this.tabClass+"|"+this.accordionClass+"|"+this.toggleClass),o=a[0].className.match(s)[0].replace(" ","."),c=n.data("content-id"),r=a.data("compotent-id"),l=n.hasClass(this.buttonActiveClass);switch(o){case this.tabClass:l||(this.hideElement(a),this.showElement(n,a,c),this.localStorage[r]=new Array(c),this.setState());break;case this.accordionClass:this.hideElement(a),l?this.localStorage[r]={}:(this.showElement(n,a,c),this.localStorage[r]=new Array(c)),this.setState();break;case this.toggleClass:n.toggleClass(this.buttonActiveClass).nextAll(c).toggleClass(this.showClass),Array.isArray(this.localStorage[r])?-1!==(i=this.localStorage[r].indexOf(c))?this.localStorage[r].splice(i,1):this.localStorage[r].push(c):this.localStorage[r]=new Array(c),this.setState()}return n.blur(),!1},showElement:function(e,i,n){e.addClass(this.buttonActiveClass),i.data("content-id",n),t(n,i).addClass(this.showClass)},hideElement:function(e){var i=e.data("content-id");t('[data-content-id="'+i+'"]',e).removeClass(this.buttonActiveClass),t(i,e).removeClass(this.showClass)},getState:function(){try{return JSON.parse(localStorage.getItem("interface-builder"))}catch(t){return!1}},setState:function(){try{localStorage.setItem("interface-builder",JSON.stringify(this.localStorage))}catch(t){return!1}}},control:{init:function(){this.switcher.init(),this.checkbox.init(),this.radio.init(),this.slider.init(),this.select.init(),this.media.init(),this.colorpicker.init(),this.iconpicker.init(),this.dimensions.init(),this.repeater.init()},switcher:{switcherClass:".cx-switcher-wrap",trueClass:".cx-input-switcher-true",falseClass:".cx-input-switcher-false",init:function(){t("body").on("click.cxSwitcher",this.switcherClass,this.switchState.bind(this))},switchState:function(e){var i=t(e.currentTarget),n=t(this.trueClass,i),a=t(this.falseClass,i),s=n[0].checked,o=t(e.currentTarget).closest(".cx-control-switcher").data("control-name");n.prop("checked",!s),a.prop("checked",!!s),s=n[0].checked,t(window).trigger({type:"cx-switcher-change",controlName:o,controlStatus:s})}},checkbox:{inputClass:'.cx-checkbox-input[type="hidden"]:not([name*="__i__"])',itemClass:".cx-checkbox-label, .cx-checkbox-item",init:function(){t("body").on("click.cxCheckbox",this.itemClass,this.switchState.bind(this))},switchState:function(e){var n,a=t(e.currentTarget).siblings(this.inputClass),s=a[0].checked,o=t(e.currentTarget).closest(".cx-control-checkbox"),c=o.data("control-name");a.val(s?"false":"true").attr("checked",!s),n=i.utils.serializeObject(o),t(window).trigger({type:"cx-checkbox-change",controlName:c,controlStatus:n})}},radio:{inputClass:'.cx-radio-input:not([name*="__i__"])',init:function(){t("body").on("click.cxRadio",this.inputClass,this.switchState.bind(this))},switchState:function(e){var i=t(e.currentTarget),n=t(e.currentTarget).closest(".cx-control-radio").data("control-name");t(window).trigger({type:"cx-radio-change",controlName:n,controlStatus:t(i).val()})}},slider:{init:function(){t("body").on("input.cxSlider change.cxSlider",".cx-slider-unit, .cx-ui-stepper-input",this.changeHandler.bind(this))},changeHandler:function(e){var i=t(e.currentTarget),n=i.closest(".cx-slider-wrap"),a=i.hasClass("cx-slider-unit")?".cx-ui-stepper-input":".cx-slider-unit";t(a,n).val(i.val())}},select:{selectClass:'.cx-ui-select[data-filter="false"]:not([name*="__i__"])',select2Class:'.cx-ui-select[data-filter="true"]:not([name*="__i__"]), .cx-ui-select[multiple]:not([name*="__i__"])',selectClearClass:".cx-ui-select-clear",init:function(){t(document).on("ready.cxSelect",this.selectRender.bind(this)).on("cx-control-init",this.selectRender.bind(this)).on("click.cxSelect",this.selectClearClass,this.clearSelect)},clearSelect:function(e){e.preventDefault(),t(this).siblings("select").val(null).trigger("change")},selectRender:function(e){var i=e._target?e._target:t("body");t(this.selectClass,i).each(this.selectInit.bind(this)),t(this.select2Class,i).each(this.select2Init.bind(this))},selectInit:function(e,i){var n=t(i),a=n.attr("id");n.change(function(e){t(window).trigger({type:"cx-select-change",controlName:a,controlStatus:t(e.target).val()})})},select2Init:function(e,i){var n=t(i),a=n.attr("id"),s={placeholder:n.data("placeholder")},o=n.data("post-type"),c=n.data("exclude"),r=n.data("action");r&&o&&(s.ajax={url:function(){return ajaxurl+"?action="+r+"&post_type="+o+"&exclude="+c},dataType:"json"},s.minimumInputLength=3),n.select2(s).on("change.cxSelect2",function(e){t(window).trigger({type:"cx-select2-change",controlName:a,controlStatus:t(e.target).val()})})}},media:{init:function(){t(document).on("ready.cxMedia",this.mediaRender.bind(this)).on("cx-control-init",this.mediaRender.bind(this))},mediaRender:function(e){var i=e._target?e._target:t("body"),n=t(".cx-upload-button",i);n.each(function(){var e=t(this),i=e.closest(".cx-ui-media-wrap"),n={input:t(".cx-upload-input",i),img_holder:t(".cx-upload-preview",i),title_text:e.data("title"),multiple:e.data("multi-upload"),library_type:e.data("library-type")},a=wp.media.frames.file_frame=wp.media({title:n.title_text,button:{text:n.title_text},multiple:n.multiple,library:{type:n.library_type}});if(!i.has('input[name*="__i__"]')[0]){e.off("click.cx-media").on("click.cx-media",function(){return a.open(),!1}),e.data("multi-upload")&&a.on("open",function(){var t=a.state().get("selection"),e=n.input.val();e&&(e=e.split(",")).forEach(function(e){t.add(wp.media.attachment(e))})}),a.on("select",function(){var e=a.state().get("selection").toJSON(),i=0,s="",o=t(".cx-all-images-wrap",n.img_holder),c="",r="";for(n.multiple&&(r=",");e[i];){var l=e[i],d=l.id,u="",h="";switch(l.mime){case"image/jpeg":case"image/png":case"image/gif":void 0!==l.sizes&&(u=l.sizes.thumbnail?l.sizes.thumbnail.url:l.sizes.full.url),h='<img  src="'+u+'" alt="" data-img-attr="'+d+'">';break;case"image/x-icon":h='<span class="dashicons dashicons-format-image"></span>';break;case"video/mpeg":case"video/mp4":case"video/quicktime":case"video/webm":case"video/ogg":h='<span class="dashicons dashicons-format-video"></span>';break;case"audio/mpeg":case"audio/wav":case"audio/ogg":h='<span class="dashicons dashicons-format-audio"></span>'}c+='<div class="cx-image-wrap"><div class="inner"><div class="preview-holder"  data-id-attr="'+d+'"><div class="centered">'+h+'</div></div><a class="cx-remove-image" href="#"><i class="dashicons dashicons-no"></i></a><span class="title">'+l.title+"</span></div></div>",s+=r+d,i++}n.input.val(s.replace(/(^,)/,"")).trigger("change"),o.html(c)});i.on("click",".cx-remove-image",function(){var e,i,n,a,s,o,c;return e=t(this),i=e.closest(".cx-ui-media-wrap"),n=t(".cx-upload-input",i),a=e.parent().parent(".cx-image-wrap"),s=t(".preview-holder",a).data("id-attr"),o=n.attr("value"),c=new RegExp(s+"(,*)","i"),o=(o=o.replace(c,"")).replace(/(,$)/,""),n.attr({value:o}).trigger("change"),a.remove(),!1})}}),n[0]&&t(".cx-all-images-wrap",i).sortable({items:"div.cx-image-wrap",cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,helper:"clone",opacity:.65,placeholder:"cx-media-thumb-sortable-placeholder",start:function(){},stop:function(){},update:function(){var e="";t(".cx-image-wrap",this).each(function(){var i=t(".preview-holder",this).data("id-attr");e=e+i+","}),e=e.substr(0,e.lastIndexOf(",")),t(this).parent().siblings(".cx-element-wrap").find("input.cx-upload-input").val(e).trigger("change")}})}},colorpicker:{init:function(){t(document).on("ready.cxColorpicker",this.render.bind(this)).on("cx-control-init",this.render.bind(this))},render:function(e){var i=e._target?e._target:t("body"),n=t('input.cx-ui-colorpicker:not([name*="__i__"])',i);n[0]&&n.wpColorPicker()}},iconpicker:{iconSets:{},iconSetsKey:"cx-icon-sets",init:function(){t(document).on("ready.cxIconpicker",this.setIconsSets.bind(this,window.CxIconSets)).on("ready.cxIconpicker",this.render.bind(this)).on("cx-control-init",this.render.bind(this))},setIconsSets:function(e){var i,n=this;e&&(i=e.response?e.response.CxIconSets:e,t.each(i,function(t,e){n.iconSets[t]=e}),n.setState(n.iconSetsKey,n.iconSets))},getIconsSets:function(){var t=this.getState(this.iconSetsKey);t&&(this.iconSets=t)},render:function(e){var i,n,a,s=e._target?e._target:t("body"),o=t('.cx-ui-iconpicker:not([name*="__i__"])',s),c=this;o[0]&&(this.getIconsSets(),o.each(function(){i=t(this),n=i.data("set"),a=c.iconSets[n],i.length&&a.icons&&i.iconpicker({icons:a.icons,iconBaseClass:a.iconBase,iconClassPrefix:a.iconPrefix,animation:!1,fullClassFormatter:function(t){return a.iconBase+" "+a.iconPrefix+t}}).on("iconpickerUpdated",function(){t(this).trigger("change")}),a&&t("head").append('<link rel="stylesheet" type="text/css" href="'+a.iconCSS+'"">')}))},getState:function(t){try{return JSON.parse(window.sessionStorage.getItem(t))}catch(t){return!1}},setState:function(t,e){try{window.sessionStorage.setItem(t,JSON.stringify(e))}catch(t){return!1}}},dimensions:{container:".cx-ui-dimensions",isLinked:".cx-ui-dimensions__is-linked",units:".cx-ui-dimensions__unit",unitsInput:'input[name*="[units]"]',linkedInput:'input[name*="[is_linked]"]',valuesInput:".cx-ui-dimensions__val",init:function(){t("body").on("click",this.isLinked,{self:this},this.switchLinked).on("click",this.units,{self:this},this.switchUnits).on("input",this.valuesInput+".is-linked",{self:this},this.changeLinked)},render:function(t){},switchLinked:function(e){var i=e.data.self,n=t(this),a=n.closest(i.container),s=a.find(i.linkedInput),o=a.find(i.valuesInput),c=s.val();0===parseInt(c)?(s.val(1),n.addClass("is-linked"),o.addClass("is-linked")):(s.val(0),n.removeClass("is-linked"),o.removeClass("is-linked"))},switchUnits:function(e){var i=e.data.self,n=t(this),a=n.data("unit"),s=n.closest(i.container),o=s.find(i.unitsInput),c=s.find(i.valuesInput),r=s.data("range");n.hasClass("is-active")||(n.addClass("is-active").siblings(i.units).removeClass("is-active"),o.val(a),c.attr({min:r[a].min,max:r[a].max,step:r[a].step}))},changeLinked:function(e){var i=e.data.self,n=t(this),a=n.closest(".cx-ui-dimensions__values");t(i.valuesInput,a).val(n.val())}},repeater:{repeaterContainerClass:".cx-ui-repeater-container",repeaterListClass:".cx-ui-repeater-list",repeaterItemClass:".cx-ui-repeater-item",repeaterItemHandleClass:".cx-ui-repeater-actions-box",repeaterTitleClass:".cx-ui-repeater-title",addItemButtonClass:".cx-ui-repeater-add",removeItemButtonClass:".cx-ui-repeater-remove",toggleItemButtonClass:".cx-ui-repeater-toggle",minItemClass:"cx-ui-repeater-min",sortablePlaceholderClass:"sortable-placeholder",init:function(){t(document).on("ready.cxRepeat",this.addEvents.bind(this))},addEvents:function(){t("body").on("click",this.addItemButtonClass,{self:this},this.addItem).on("click",this.removeItemButtonClass,{self:this},this.removeItem).on("click",this.toggleItemButtonClass,{self:this},this.toggleItem).on("change",this.repeaterListClass+" input, "+this.repeaterListClass+" textarea, "+this.repeaterListClass+" select",{self:this},this.changeWrapperLable).on("sortable-init",{self:this},this.sortableItem),t(document).on("cx-control-init",{self:this},this.sortableItem),this.triggers()},triggers:function(e){return t("body").trigger("sortable-init"),e&&t(document).trigger("cx-control-init",{target:e}),this},addItem:function(e){var i=e.data.self,n=t(this).prev(i.repeaterListClass),a=n.data("index"),s=n.data("name"),o=wp.template(s),c=n.data("widget-id"),r={index:a},l=n.parent().closest(i.repeaterListClass);(c="__i__"!==c?c:n.attr("id"))&&(r.widgetId=c),l.length&&(r.parentIndex=parseInt(l.data("index"),10)-1),n.append(o(r)),a++,n.data("index",a),i.triggers(t(i.repeaterItemClass+":last",n)).stopDefaultEvent(e)},removeItem:function(e){var i=e.data.self,n=t(this).closest(i.repeaterListClass);i.applyChanges(n),t(this).closest(i.repeaterItemClass).remove(),i.triggers().stopDefaultEvent(e)},toggleItem:function(e){var i=e.data.self;t(this).closest(i.repeaterItemClass).toggleClass(i.minItemClass),i.stopDefaultEvent(e)},sortableItem:function(e){var i,n=e.data.self;t(n.repeaterListClass).each(function(e,a){i=t(a),t(a).data("sortable-init")?i.sortable("refresh"):i.sortable({items:n.repeaterItemClass,handle:n.repeaterItemHandleClass,cursor:"move",scrollSensitivity:40,forcePlaceholderSize:!0,forceHelperSize:!1,distance:2,tolerance:"pointer",helper:function(t,e){return e.clone().find(":input").attr("name",function(t,e){return"sort_"+parseInt(1e5*Math.random(),10).toString()+"_"+e}).end()},opacity:.65,placeholder:n.sortablePlaceholderClass,create:function(){i.data("sortable-init",!0)},update:function(e){var i=t(e.target);n.applyChanges(i)}})})},changeWrapperLable:function(e){var i,n,a=e.data.self,s=t(a.repeaterListClass).data("title-field"),o=t(this);s&&o.closest("."+s+"-wrap")[0]&&(i=o.val(),n=o.closest(a.repeaterItemClass),t(a.repeaterTitleClass,n).html(i)),a.stopDefaultEvent(e)},applyChanges:function(e){return void 0!==wp.customize&&t("input[name]:first, select[name]:first",e).change(),this},stopDefaultEvent:function(t){return t.preventDefault(),t.stopImmediatePropagation(),t.stopPropagation(),this}}},utils:{serializeObject:function(e){var i,n=this,a={},s={},o={validate:/^[a-zA-Z][a-zA-Z0-9_-]*(?:\[(?:\d*|[a-zA-Z0-9_-]+)\])*$/,key:/[a-zA-Z0-9_-]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_-]+$/};return this.build=function(t,e,i){return t[e]=i,t},this.push_counter=function(t){return void 0===s[t]&&(s[t]=0),s[t]++},i="FORM"===e[0].tagName?e.serializeArray():e.find("input, textarea, select").serializeArray(),t.each(i,function(){var e,i,s,c;if(o.validate.test(this.name)){for(i=this.name.match(o.key),s=this.value,c=this.name;void 0!==(e=i.pop());)c=c.replace(new RegExp("\\["+e+"\\]$"),""),e.match(o.push)?s=n.build([],n.push_counter(c),s):e.match(o.fixed)?s=n.build([],e,s):e.match(o.named)&&(s=n.build({},e,s));a=t.extend(!0,a,s)}}),a},filterBoolValue:function(t){var e=+t;return isNaN(e)?!!String(t).toLowerCase().replace(!1,""):!!e}}};i.init()}(jQuery,window._);